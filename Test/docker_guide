# 도커 컴포즈의 버전지정
version: '3.8'

# 컨테이너를 실행하기 위한 단위
# 서비스 목록을 정의한다.
services:
  <서비스 이름>:
    # build 명령을 실행할 경로
    build: <경로>
      # build 경로를 설정함.
      context: <빌드 위치>
      # 변수 입력
      args:
        - <변수>=<값>
      # Docker 이미지를 빌드하는데 사용할 Docker 파일(이름이 dockerfile이 아니면 지정)
      dockerfile: <도커 파일 위치>

    # 서비스의 네트워크를 지정
    networks:
      - <네트워크 이름>

    # 호스트 이름 지정
    hostname: <호스트 이름>

    # 컨테이너가 예상치못하게 종료되어도 다시 띄워준다.
    restart: always

    # 포트포워딩설정
    ports:
      - <호스트 포트>:<컨테이너 포트>
      # or
      - target: <컨테이너 포트>
        publish: <호스트 포트>
        protocol: <포트 프로토콜>

    # docker compose의 entrypoint가 docker의 entrypoint보다 우선순위가 높다.
    entrypoint: <bash 명령어>
    
    # Storage Mount(Volume) 지정
    volumes:
      - <볼륨 이름>:<볼륨 경로>
    
    # 의존 관계를 설정하여 실행순서를 보장받고 싶을 때 사용.
    depends_on:
      - <예시1번>
    # 파일내 정의된 다른 컨테이너와의 통신이 필요할때 연결
    links:
      - <예시1번>
 
    #작업 디렉토리를 지정할 수 있음
    working_dir: <작업 디렉토리>

    # 네트워크 모드를 설정, 기본적으론 도커 내부 네트워크 사용.
    network_mode: host

    # 환경변수 지정
    environment:
      - <환경변수 이름>=<값>

    # 사용할 이미지를 지정한다.
    image: <이미지 이름>:<버전>
    
    # 커멘드의 변경이 필요하다면 재정의가능
    command: <명령어>


# 네트워크 생성
networks:
  - <네트워크 이름>

# 볼륨 생성
volumes:
